import { Injectable, EventEmitter } from '@angular/core';
import { Http, Headers, Response } from '@angular/http';
import 'rxjs/Rx';

import {Recipe} from './recipe';
import {Ingredient} from '../ingredient';

@Injectable()
export class RecipeService {

  recipesChanged = new EventEmitter<Recipe[]>();

  recipes:Recipe[] =[
    new Recipe('Schnitzel', 'Very tasty', 'data:image/jpeg;base64,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', [
        new Ingredient('French Fries', 2),
        new Ingredient('Goat Meat', 1)
    ]),
    new Recipe('Summer Salad', 'Okayish', 'http://cdn.iowagirleats.com/wp-content/uploads/2013/05/Triple-Berry-Summer-Salad-03_mini.jpg', [])
  ];

  constructor(private http:Http) { }

  getRecipes() {
    return this.recipes;
  }
  
  getRecipe(id:number) {
    return this.recipes[id];
  }

  deleteRecipe(recipe: Recipe) {
    this.recipes.splice(this.recipes.indexOf(recipe), 1);
  } 
  
  addRecipe(recipe: Recipe) {
    this.recipes.push(recipe);
  }
     
  editRecipe(oldRecipe: Recipe, newRecipe: Recipe) {
    this.recipes[this.recipes.indexOf(oldRecipe)] = newRecipe;
  }
  
  storeData() {
    const body = JSON.stringify(this.recipes);
    const headers = new Headers({
        'Content-Type':'application/json'
    });
    return this.http.put('https://recipebook-928d1.firebaseio.com/recipes.json', body, {headers: headers});
  }
  
  fetchData() {
    return this.http.get('https://recipebook-928d1.firebaseio.com/recipes.json')
            .map((response: Response) => response.json())
            .subscribe(
                (data: Recipe[]) => {
                    this.recipes = data;
                    this.recipesChanged.emit(data);
                    console.log(data);
                }
            );
  }
  
}
